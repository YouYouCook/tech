<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="SERVICE_B_SERVICE_CONFIG_CODE" >
  <resultMap id="ServiceConfigCodeResult" class="cn.id5.idreal_hr.commons.bo.service.ServiceConfigCodeBO" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Mon Feb 21 15:38:10 CST 2011.
    -->
    <result column="SCC_ID" property="sccId" jdbcType="DECIMAL" />
    <result column="SC_ID" property="scId" jdbcType="DECIMAL" />
    <result column="SCC_SERVICE_CODE" property="sccServiceCode" jdbcType="DECIMAL" />
    <result column="SCC_INIT_PASSWORD" property="sccInitPassword" jdbcType="VARCHAR" />
    <result column="SCC_PASSWORD" property="sccPassword" jdbcType="VARCHAR" />
    <result column="SCC_SERVICE_STARTTIME" property="sccServiceStarttime" jdbcType="VARCHAR" />
    <result column="SCC_SERVICE_ENDTIME" property="sccServiceEndtime" jdbcType="VARCHAR" />
    <result column="SCC_STATUS" property="sccStatus" jdbcType="CHAR" />
    <result column="SCC_REMARK" property="sccRemark" jdbcType="VARCHAR" />
    <result column="SCC_EMPLOYEE_NO" property="sccEmployeeNo" jdbcType="VARCHAR" />
    <result column="SCC_CHECK_REPORT" property="sccCheckReport" jdbcType="VARCHAR" />
    <result column="SCC_INIT_TIME" property="sccInitTime" jdbcType="VARCHAR" />
    <result column="SCC_ACCEPT_ORDER_TIME" property="sccAcceptOrderTime" jdbcType="VARCHAR" />
    <result column="SCC_CHECK_START_TIME" property="sccCheckStartTime" jdbcType="VARCHAR" />
    <result column="SCC_CHECK_END_TIME" property="sccCheckEndTime" jdbcType="VARCHAR" />
    <result column="SCC_CREATEUSER" property="sccCreateuser" jdbcType="VARCHAR" />
    <result column="SCC_CREATETIME" property="sccCreatetime" jdbcType="VARCHAR" />
    <result column="SCC_MODIFYUSER" property="sccModifyuser" jdbcType="VARCHAR" />
    <result column="SCC_MODIFYTIME" property="sccModifytime" jdbcType="VARCHAR" />
    <result column="SCC_EXT1" property="sccExt1" jdbcType="VARCHAR" />
    <result column="SCC_EXT2" property="sccExt2" jdbcType="VARCHAR" />
    <result column="SCC_EXT3" property="sccExt3" jdbcType="VARCHAR" />
    <result column="CUSTOMER_CODE" property="customerCode" jdbcType="VARCHAR" />
    <result column="SCC_SUBMIT_TIME" property="sccSubmitTime" jdbcType="VARCHAR" />
  </resultMap>
  <resultMap id="ServiceConfigCodeShowResult" class="cn.id5.idreal_hr.commons.bo.service.ServiceConfigCodeShowBO" >
    <!--
      Service Code 列表显示
    -->
    <result column="SCC_SERVICE_CODE" property="sccServiceCode" jdbcType="DECIMAL" />
    <result column="SCC_INIT_PASSWORD" property="sccInitPassword" jdbcType="VARCHAR" />
    <result column="SC_SERVICE_NAME" property="scServiceName" jdbcType="VARCHAR" />
    <result column="SCC_STATUS" property="sccStatus" jdbcType="CHAR" />
    <result column="SCC_SERVICE_STARTTIME" property="sccServiceStarttime" jdbcType="VARCHAR" />
    <result column="SCC_SERVICE_ENDTIME" property="sccServiceEndtime" jdbcType="VARCHAR" />
  </resultMap>
  <select id="selectByPrimaryKey" resultMap="ServiceConfigCodeResult" parameterClass="cn.id5.idreal_hr.commons.bo.service.ServiceConfigCodeBO" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Mon Feb 21 15:38:10 CST 2011.
    -->
    select SCC_ID, SC_ID, SCC_SERVICE_CODE, SCC_INIT_PASSWORD, SCC_PASSWORD, SCC_SERVICE_STARTTIME,
      SCC_SERVICE_ENDTIME, SCC_STATUS, SCC_REMARK, SCC_EMPLOYEE_NO, SCC_CHECK_REPORT, SCC_INIT_TIME,
      SCC_ACCEPT_ORDER_TIME, SCC_CHECK_START_TIME, SCC_CHECK_END_TIME, SCC_CREATEUSER,
      SCC_CREATETIME, SCC_MODIFYUSER, SCC_MODIFYTIME, SCC_EXT1, SCC_EXT2, SCC_EXT3, CUSTOMER_CODE,SCC_SUBMIT_TIME
    from B_SERVICE_CONFIG_CODE
    where SCC_ID = #sccId#
  </select>
  <select id="selectByOrderId" resultMap="ServiceConfigCodeShowResult" parameterClass="java.lang.String" >
    <!--
      根据订单号查询服务配置对应的 service code 数据
    -->
    select scc.scc_service_code,
	       scc.scc_init_password,
	       sc.sc_service_name,
	       scc.scc_status,
	       scc.scc_service_starttime,
	       scc.scc_service_endtime
	  from b_service_config_code scc, b_service_config sc
	 where sc.sc_id = scc.sc_id
	   and sc.sc_order_id = #value#
  </select>
  <select id="selectAll" resultMap="ServiceConfigCodeShowResult" parameterClass="java.util.Map" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Mon Feb 21 15:38:10 CST 2011.
    -->
     SELECT * FROM ( SELECT ROWNUM AS NUMROW, c.* from ( 
    select scc.scc_service_code,
	       scc.scc_init_password,
	       sc.sc_service_name,
	       scc.scc_status,
	       scc.scc_service_starttime,
	       scc.scc_service_endtime
	  from b_service_config_code scc, b_service_config sc
	 where sc.sc_id = scc.sc_id
	   and sc.sc_order_id = #scOrderId#
    <dynamic>
	    <isNotNull prepend="AND" property="seatAccount">
		    <isEqual property="seatIsAdmin" compareValue="0">
		     scc.customer_code = (
		     	 select customer_code from c_t_customer where customer_id = (
		     	 		select customer_id from c_t_seat where seat_account = #seatAccount#
		     	 )
		     )
			</isEqual>
		    <isEqual property="seatIsAdmin" compareValue="1">
		     scc.SCC_CREATEUSER = #seatAccount#
		    </isEqual>
	    </isNotNull>
	    <isNotNull prepend="AND" property="sccServiceCode">
	    	scc.scc_service_code = #sccServiceCode#
	    </isNotNull>
     ) c) 
	    <isNotNull property="ibegin">
     <![CDATA[ WHERE NUMROW >= $ibegin$  AND NUMROW < $iend$  ]]>
	    </isNotNull>
	</dynamic>
  </select>
  <select id="selectAllOfCount" resultClass="java.lang.String" parameterClass="java.util.Map" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Mon Feb 21 15:38:10 CST 2011.
    -->
     SELECT count(1) as ID from ( 
    select scc.scc_service_code,
	       scc.scc_init_password,
	       sc.sc_service_name,
	       scc.scc_status,
	       scc.scc_service_starttime,
	       scc.scc_service_endtime
	  from b_service_config_code scc, b_service_config sc
	 where sc.sc_id = scc.sc_id
	   and sc.sc_order_id = #scOrderId#
    <dynamic>
	    <isNotNull prepend="AND" property="seatAccount">
		    <isEqual property="seatIsAdmin" compareValue="0">
		     scc.customer_code = (
		     	 select customer_code from c_t_customer where customer_id = (
		     	 		select customer_id from c_t_seat where seat_account = #seatAccount#
		     	 )
		     )
			</isEqual>
		    <isEqual property="seatIsAdmin" compareValue="1">
		     scc.SCC_CREATEUSER = #seatAccount#
		    </isEqual>
	    </isNotNull>
	    <isNotNull prepend="AND" property="sccServiceCode">
	    	scc.scc_service_code = #sccServiceCode#
	    </isNotNull>
	</dynamic>
     ) 
  </select>
  <delete id="deleteByPrimaryKey" parameterClass="cn.id5.idreal_hr.commons.bo.service.ServiceConfigCodeBO" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Mon Feb 21 15:38:10 CST 2011.
    -->
    delete from B_SERVICE_CONFIG_CODE
    where SCC_ID = #sccId#
  </delete>
  <insert id="insert" parameterClass="cn.id5.idreal_hr.commons.bo.service.ServiceConfigCodeBO" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Mon Feb 21 15:38:10 CST 2011.
    -->
    <selectKey resultClass="java.math.BigDecimal" keyProperty="sccId" >
      SELECT SEQ_B_SERVICE_CONFIG_CODE.NEXTVAL AS ID FROM DUAL
    </selectKey>
    insert into B_SERVICE_CONFIG_CODE (SCC_ID, SC_ID, SCC_SERVICE_CODE, SCC_INIT_PASSWORD,
      SCC_PASSWORD, SCC_SERVICE_STARTTIME, SCC_SERVICE_ENDTIME, SCC_STATUS, SCC_REMARK,
      SCC_EMPLOYEE_NO, SCC_CHECK_REPORT, SCC_INIT_TIME, SCC_ACCEPT_ORDER_TIME, SCC_CHECK_START_TIME,
      SCC_CHECK_END_TIME, SCC_CREATEUSER, SCC_CREATETIME, SCC_MODIFYUSER, SCC_MODIFYTIME, SCC_EXT1,
      SCC_EXT2, SCC_EXT3, CUSTOMER_CODE,SCC_SUBMIT_TIME)
    values (#sccId#, #scId#, #sccServiceCode#, #sccInitPassword#, #sccPassword#,
      #sccServiceStarttime#, #sccServiceEndtime#, #sccStatus#, #sccRemark#, #sccEmployeeNo#,
      #sccCheckReport#, #sccInitTime#, #sccAcceptOrderTime#, #sccCheckStartTime#, #sccCheckEndTime#,
      #sccCreateuser#, to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'), #sccModifyuser#, #sccModifytime#, #sccExt1#, #sccExt2#,
      #sccExt3#, #customerCode#, #sccSubmitTime#)
  </insert>
  <insert id="insertBatch" parameterClass="cn.id5.idreal_hr.commons.bo.service.ServiceConfigCodeBO" >
    <!--  批量插入  -->
    insert into B_SERVICE_CONFIG_CODE (SCC_ID, SC_ID, SCC_SERVICE_CODE, SCC_INIT_PASSWORD,
      SCC_PASSWORD, SCC_SERVICE_STARTTIME, SCC_SERVICE_ENDTIME, SCC_STATUS, SCC_REMARK,
      SCC_EMPLOYEE_NO, SCC_CHECK_REPORT, SCC_INIT_TIME, SCC_ACCEPT_ORDER_TIME, SCC_CHECK_START_TIME,
      SCC_CHECK_END_TIME, SCC_CREATEUSER, SCC_CREATETIME, SCC_MODIFYUSER, SCC_MODIFYTIME, SCC_EXT1,
      SCC_EXT2, SCC_EXT3, CUSTOMER_CODE,SCC_SUBMIT_TIME)
    values (#sccId#, #scId#, #sccServiceCode#, #sccInitPassword#, #sccPassword#,
      #sccServiceStarttime#, #sccServiceEndtime#, #sccStatus#, #sccRemark#, #sccEmployeeNo#,
      #sccCheckReport#, #sccInitTime#, #sccAcceptOrderTime#, #sccCheckStartTime#, #sccCheckEndTime#,
      #sccCreateuser#, to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'), #sccModifyuser#, #sccModifytime#, #sccExt1#, #sccExt2#,
      #sccExt3#, #customerCode#, #sccSubmitTime#)
  </insert>
  <update id="updateByPrimaryKey" parameterClass="cn.id5.idreal_hr.commons.bo.service.ServiceConfigCodeBO" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Mon Feb 21 15:38:10 CST 2011.
    -->
    update B_SERVICE_CONFIG_CODE
    set SC_ID = #scId#,
      SCC_SERVICE_CODE = #sccServiceCode#,
      SCC_INIT_PASSWORD = #sccInitPassword#,
      SCC_PASSWORD = #sccPassword#,
      SCC_SERVICE_STARTTIME = #sccServiceStarttime#,
      SCC_SERVICE_ENDTIME = #sccServiceEndtime#,
      SCC_STATUS = #sccStatus#,
      SCC_REMARK = #sccRemark#,
      SCC_EMPLOYEE_NO = #sccEmployeeNo#,
      SCC_CHECK_REPORT = #sccCheckReport#,
      SCC_INIT_TIME = #sccInitTime#,
      SCC_ACCEPT_ORDER_TIME = #sccAcceptOrderTime#,
      SCC_CHECK_START_TIME = #sccCheckStartTime#,
      SCC_CHECK_END_TIME = #sccCheckEndTime#,
      SCC_CREATEUSER = #sccCreateuser#,
      SCC_CREATETIME = #sccCreatetime#,
      SCC_MODIFYUSER = #sccModifyuser#,
      SCC_MODIFYTIME = #sccModifytime#,
      SCC_EXT1 = #sccExt1#,
      SCC_EXT2 = #sccExt2#,
      SCC_EXT3 = #sccExt3#,
      CUSTOMER_CODE = #customerCode#,
      SCC_SUBMIT_TIME = #sccSubmitTime#
    where SCC_ID = #sccId#
  </update>
  
  <!-- 功能性查询 -->
  <select id="generateServiceCode" resultClass="java.lang.String">
    <!-- 服务编码生成 -->
	select to_char(sysdate,'yymmdd')||'@'||lpad(seq_service_code.nextval,6,'0') from dual
  </select>
  <select id="getSccId" resultClass="java.math.BigDecimal">
    <!-- 根据对应seq获取SccId -->
    SELECT SEQ_B_SERVICE_CONFIG_CODE.NEXTVAL AS ID FROM DUAL
  </select>
</sqlMap>