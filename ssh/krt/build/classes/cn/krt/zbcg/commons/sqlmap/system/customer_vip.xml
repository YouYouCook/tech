<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="customer_vip" >
  <resultMap id="OmerVipResult" class="cn.krt.zbcg.commons.bo.system.CustomerVipBO" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Sat Oct 01 10:17:08 CST 2011.
    -->
    <result column="vip_id" property="vipId" jdbcType="INTEGER" />
    <result column="customer_id" property="customerId" jdbcType="INTEGER" />
    <result column="medicine_id" property="medicineId" jdbcType="INTEGER" />
     <result column="state" property="state" jdbcType="VARCHAR" />
     <result property="medicineBO" column="medicine_id" select="medicine.selectById"/>
     <result property="customerBO" column="customer_id" select="customer.selectById"/>
  </resultMap>
  <select id="selectByPrimaryKey" resultMap="OmerVipResult" parameterClass="cn.krt.zbcg.commons.bo.system.CustomerVipBO" >
  
    select vip_id, customer_id, medicine_id,''as state
    from customer_vip
    where vip_id = #vipId#
  </select>
  
  <select id="findVipCustomer" resultMap="OmerVipResult" parameterClass="java.util.Map" >
    select vip_id, customer_vip.customer_id, customer_vip.medicine_id,vip_zb.state as state
    from customer_vip 
    left join vip_zb on 
    customer_vip.customer_id=vip_zb.customer_id and
     customer_vip.medicine_id=vip_zb.medicine_id and vip_zb.begin_date=#beginDate#
    where customer_vip.medicine_id = #medicineId#
  </select>
  
  <select id="findVipCustomerOne" resultMap="OmerVipResult" parameterClass="cn.krt.zbcg.commons.bo.system.CustomerVipBO">
    select vip_id, customer_id, medicine_id,''as state
    from customer_vip
    where customer_id = #customerId# and medicine_id = #medicineId#
  </select>
  
  <select id="selectAll"  resultMap="OmerVipResult" parameterClass="java.util.Map" >
     SELECT * FROM ( SELECT  c.* from ( 
     select vip_id, customer_id, medicine_id,''as state
    from customer_vip
     ) c) a
     LIMIT  $ibegin$, 10
  </select>
  <select id="selectAllOfCount" resultClass="java.lang.String" parameterClass="java.util.Map" >
     SELECT count(1) as ID from ( 
     select vip_id, customer_id, medicine_id,'' as state
    from customer_vip
     ) a
  </select>
  <delete id="deleteByPrimaryKey" parameterClass="cn.krt.zbcg.commons.bo.system.CustomerVipBO" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Sat Oct 01 10:17:08 CST 2011.
    -->
    delete from customer_vip
    where vip_id = #vipId#
  </delete>
  <insert id="insert" parameterClass="cn.krt.zbcg.commons.bo.system.CustomerVipBO" >
    insert into customer_vip (vip_id, customer_id, medicine_id)
    values (#vipId#, #customerId#, #medicineId#)
  </insert>
  <update id="updateByPrimaryKey" parameterClass="cn.krt.zbcg.commons.bo.system.CustomerVipBO" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Sat Oct 01 10:17:08 CST 2011.
    -->
    update customer_vip
    set customer_id = #customerId#,
      medicine_id = #medicineId#
    where vip_id = #vipId#
  </update>
  <select id="checkResult" resultMap="OmerVipResult" parameterClass="cn.krt.zbcg.commons.bo.system.CustomerVipBO" >
  
    select vip_id, customer_id, medicine_id,''as state
    from customer_vip
    where customer_id = #customerId# and medicine_id = #medicineId#
  </select>
</sqlMap>