<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="C_T_CUSTOMER" >
<typeAlias alias="customerBO" type="cn.id5.idreal_hr.commons.bo.businesses.CustomerBO"/>
  <resultMap id="CustomerResult" class="cn.id5.idreal_hr.commons.bo.businesses.CustomerBO" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
    -->
    <result column="CUSTOMER_ID" property="customerId" jdbcType="DECIMAL" />
    <result column="CUSTOMER_CODE" property="customerCode" jdbcType="VARCHAR" />
    <result column="CUSTOMER_LEVEL" property="customerLevel" jdbcType="VARCHAR" />
    <result column="CUSTOMER_SHORT_NAME" property="customerShortName" jdbcType="VARCHAR" />
    <result column="CUSTOMER_NAME" property="customerName" jdbcType="VARCHAR" />
    <result column="CUSTOMER_CONTACT" property="customerContact" jdbcType="VARCHAR" />
    <result column="CONTACT_EMAIL" property="contactEmail" jdbcType="VARCHAR" />
    <result column="CONTACT_TEL" property="contactTel" jdbcType="VARCHAR" />
    <result column="CONTACT_MOBILE" property="contactMobile" jdbcType="VARCHAR" />
    <result column="CONTACT_FAX" property="contactFax" jdbcType="VARCHAR" />
    <result column="CUSTOMER_ZIP" property="customerZip" jdbcType="VARCHAR" />
    <result column="CUSTOMER_ADDRESS" property="customerAddress" jdbcType="VARCHAR" />
    <result column="CUSTOMER_SAIL" property="customerSail" jdbcType="VARCHAR" />
    <result column="PROVINCE" property="province" jdbcType="VARCHAR" />
    <result column="CITY" property="city" jdbcType="VARCHAR" />
    <result column="INDUSTRY_PROPERTY" property="industryProperty" jdbcType="VARCHAR" />
    <result column="BILLING_TYPE" property="billingType" jdbcType="VARCHAR" />
    <result column="APP_FIELD" property="appField" jdbcType="VARCHAR" />
    <result column="WEB_TEST_IP" property="webTestIp" jdbcType="VARCHAR" />
    <result column="WEB_OFFICIAL_IP" property="webOfficialIp" jdbcType="VARCHAR" />
    <result column="WS_TEST_IP" property="wsTestIp" jdbcType="VARCHAR" />
    <result column="WS_OFFICIAL_IP" property="wsOfficialIp" jdbcType="VARCHAR" />
    <result column="OUTSTANDING" property="outstanding" jdbcType="DECIMAL" />
    <result column="RECORD_STATE" property="recordState" jdbcType="VARCHAR" />
    
  </resultMap>
  
    <resultMap id="CustomerResult_res" class="customerBO" extends="CustomerResult">
        <result property="provinceBO" column="PROVINCE" select="I_T_PROVINCE.selectByCode"/>
        <result property="cityBO" column="CITY" select="I_T_CITY.selectByCode"/>
  	</resultMap>
  	 <select id="findSubUnitByCode" resultMap="CustomerResult" parameterClass="cn.id5.idreal_hr.commons.bo.businesses.CustomerBO" >
    <!--
                根据客户编号查找改客户的直属下级单位
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
    -->
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
    from C_T_CUSTOMER where 1=1
   	and CUSTOMER_CODE like '$customerCode$%'
   	and length(CUSTOMER_CODE)=length('$customerCode$')+3
   	<!-- add by xinjuan  -->
   	and RECORD_STATE=1
  </select>
  <select id="selectByPrimaryKey" resultMap="CustomerResult" parameterClass="cn.id5.idreal_hr.commons.bo.businesses.CustomerBO" >
    <!--
      根据主键查找对象
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
    -->
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
    from C_T_CUSTOMER
    where CUSTOMER_ID = #customerId#
  </select>
   <select id="selectById" resultMap="CustomerResult" parameterClass="java.lang.Long" >
    <!--
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
    -->
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
    from C_T_CUSTOMER
    where CUSTOMER_ID = #customerId#
  </select>
   <select id="selectByCode" resultMap="CustomerResult" parameterClass="cn.id5.idreal_hr.commons.bo.businesses.CustomerBO" >
    <!--根据编号查找单位
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
    -->
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
    from C_T_CUSTOMER
    where CUSTOMER_CODE = #customerCode#
   	and RECORD_STATE=1
  </select>
  <select id="selectCustomerIdByUnitId" resultMap="CustomerResult" parameterClass="cn.id5.idreal_hr.commons.bo.businesses.CustomerBO" >
    <!--根据下级单位id查找一级单位id
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
    -->
      select * from c_t_customer cus
  		where cus.customer_code in 
  			(select substr(u.customer_code,0,3) from c_t_customer u where u.customer_id=#customerId# and RECORD_STATE=1)
  		and RECORD_STATE=1
  </select>
   <select id="selectByName" resultMap="CustomerResult" parameterClass="cn.id5.idreal_hr.commons.bo.businesses.CustomerBO" >
    <!--根据编号查找单位
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
    -->
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
    from C_T_CUSTOMER
    where CUSTOMER_NAME = #customerName#
   	and RECORD_STATE=1 
  </select>
    <select id="selectByShortName" resultMap="CustomerResult" parameterClass="cn.id5.idreal_hr.commons.bo.businesses.CustomerBO" >
    <!--根据单位缩写查找单位
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
    -->
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
    from C_T_CUSTOMER
    where CUSTOMER_SHORT_NAME = #customerShortName#
   	and RECORD_STATE=1
  </select>
   <select id="selectAllOfCount" resultClass="java.lang.String" parameterClass="java.util.Map" >
    <!--
      显示当前坐席的下级单位的列表count
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
    -->
     SELECT count(1) as ID from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE, RECORD_TYPE
    from C_T_CUSTOMER
     ) where 1=1
      and RECORD_STATE=1
      <isNotNull property="customerName">
				<isNotEmpty  property="customerName">
				 and  CUSTOMER_NAME like '%$customerName$%'
				</isNotEmpty>
	  </isNotNull>
	  <isNotNull property="province">
				<isNotEmpty  property="province">
				 and  PROVINCE = '$province$'
				</isNotEmpty>
	</isNotNull>
	  <isNotNull property="city">
				<isNotEmpty  property="city">
				 and  CITY = '$city$'
				</isNotEmpty>
	</isNotNull>
	and CUSTOMER_CODE like '$superiorCode$%'
	and  CUSTOMER_CODE !=  '$superiorCode$'
	<isNotNull property="codelength">
				<isNotEmpty  property="codelength">
				 and  length(CUSTOMER_CODE) = '$codelength$'
				</isNotEmpty>
	</isNotNull>
  </select>
  <select id="selectAll" resultMap="CustomerResult_res" parameterClass="java.util.Map" >
    <!--
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
     查询所有单位
    -->
     SELECT * FROM ( SELECT ROWNUM AS NUMROW, c.* from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
    from C_T_CUSTOMER where 1=1 and RECORD_STATE=1 
      <isNotNull property="customerName">
				<isNotEmpty  property="customerName">
				 and  CUSTOMER_NAME like '%$customerName$%'
				</isNotEmpty>
	</isNotNull>
	  <isNotNull property="province">
				<isNotEmpty  property="province">
				 and  PROVINCE = '$province$'
				</isNotEmpty>
	</isNotNull>
	  <isNotNull property="city">
				<isNotEmpty  property="city">
				 and  CITY = '$city$'
				</isNotEmpty>
	</isNotNull>
	and CUSTOMER_CODE like '$superiorCode$%'
	and  CUSTOMER_CODE !=  '$superiorCode$'
	<isNotNull property="codelength">
				<isNotEmpty  property="codelength">
				 and  length(CUSTOMER_CODE) = '$codelength$'
				</isNotEmpty>
	</isNotNull>
	 order by CUSTOMER_ID desc
     ) c) 
     <![CDATA[ WHERE NUMROW >= $ibegin$  AND NUMROW < $iend$  ]]>
     
	
	
  </select>
    <select id="selectAllFirstCustomerf" resultMap="CustomerResult_res" parameterClass="java.util.Map" >
    <!--
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
      在坐席管理（国政通）列表页面，点击查询按钮时使用  查找所有的一级客户
    -->
     SELECT * FROM ( SELECT ROWNUM AS NUMROW, c.* from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
	    from C_T_CUSTOMER where 1=1 
	    and RECORD_STATE=1
		and  length(CUSTOMER_CODE) =  3
		<isNotNull property="customerName">
			<isNotEmpty  property="customerName">
				 and  CUSTOMER_NAME like '%$customerName$%'
			</isNotEmpty>
	    </isNotNull>
     ) c) 
     <![CDATA[ WHERE NUMROW >= $ibegin$  AND NUMROW < $iend$  ]]>
  </select>
   <select id="selectAllFirstCustomerCountf" resultClass="java.lang.String" parameterClass="java.util.Map" >
    <!--
      在坐席管理（国政通）列表页面，点击查询按钮时使用  查找所有的一级客户
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
    -->
     SELECT count(1) as ID from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
   	  from C_T_CUSTOMER where 1=1 
	    and RECORD_STATE=1
		and  length(CUSTOMER_CODE) =  3
		<isNotNull property="customerName">
			<isNotEmpty  property="customerName">
				 and  CUSTOMER_NAME like '%$customerName$%'
			</isNotEmpty>
	    </isNotNull>
     ) 
  </select>
   <select id="selectAllFirstCustomer" resultMap="CustomerResult_res" parameterClass="java.util.Map" >
    <!--
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
      在新增客户管理员时查询没有客户管理员的一级单位
    -->
     SELECT * FROM ( SELECT ROWNUM AS NUMROW, c.* from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
	    from C_T_CUSTOMER where 1=1 
	    and RECORD_STATE=1
		and  length(CUSTOMER_CODE) =  3
		<isNotNull property="customerName">
				<isNotEmpty  property="customerName">
				 and  CUSTOMER_NAME like '%$customerName$%'
				</isNotEmpty>
	    </isNotNull>
		and customer_id not in
                        (select seat.customer_id
                           from c_t_seat seat
                          where seat.seat_is_admin = 0
                            and seat.seat_state = 1
                            and seat.seat_type = 1
                            and seat.customer_id is not null)
     ) c) 
     <![CDATA[ WHERE NUMROW >= $ibegin$  AND NUMROW < $iend$  ]]>
  </select>
  <select id="selectAllFirstCustomerCount" resultClass="java.lang.String" parameterClass="java.util.Map" >
    <!--
      当查找没有管理员的一级单位时用到的分页
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
    -->
     SELECT count(1) as ID from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
   	  from C_T_CUSTOMER where 1=1 
	    and RECORD_STATE=1
		and  length(CUSTOMER_CODE) =  3
		<isNotNull property="customerName">
				<isNotEmpty  property="customerName">
				 and  CUSTOMER_NAME like '%$customerName$%'
				</isNotEmpty>
	    </isNotNull>
		and customer_id not in
                        (select seat.customer_id
                           from c_t_seat seat
                          where seat.seat_is_admin = 0
                            and seat.seat_state = 1
                            and seat.seat_type = 1
                            and seat.customer_id is not null)
     ) 
  </select>
   <select id="selectAllById5" resultMap="CustomerResult_res" parameterClass="java.util.Map" >
    <!--
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
     查找所有的客户管理员和webService账号
    -->
     SELECT * FROM ( SELECT ROWNUM AS NUMROW, c.* from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
	    from C_T_CUSTOMER where 1=1 
	    and RECORD_STATE=1
		and  length(CUSTOMER_CODE) =  3
		and customer_id not in(
	           select seat.customer_id from c_t_seat seat
	           where  seat.seat_is_admin=0
	           and seat.seat_state=1
	           and seat.seat_type=1
    	   )
     ) c) 
     <![CDATA[ WHERE NUMROW >= $ibegin$  AND NUMROW < $iend$  ]]>
  </select>
  
   <select id="selectCountById5" resultClass="java.lang.String" parameterClass="java.util.Map" >
    <!--
      查找所有的客户管理员和ws账号时用来查找总数据的
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
    -->
     SELECT count(1) as ID from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
   	  from C_T_CUSTOMER where 1=1 
	    and RECORD_STATE=1
		and  length(CUSTOMER_CODE) =  3
		and customer_id not in(
	           select seat.customer_id from c_t_seat seat
	           where  seat.seat_is_admin=0
	           and seat.seat_state=1
	           and seat.seat_type=1
    	   )
     ) 
  </select>
  <select id="selectSubUnit" resultMap="CustomerResult_res" parameterClass="java.util.Map" >
    <!--
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
      查找当前用户所在单位的所有的下级单位
    -->
     SELECT * FROM ( SELECT ROWNUM AS NUMROW, c.* from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
	    from C_T_CUSTOMER where 1=1 
	    and RECORD_STATE=1
		and  length(CUSTOMER_CODE) =  '$codeLength$'
		and CUSTOMER_CODE like '$superiorCode$%'
     ) c) 
     <![CDATA[ WHERE NUMROW >= $ibegin$  AND NUMROW < $iend$  ]]>
  </select>
  <select id="selectSubUnitCount" resultClass="java.lang.String" parameterClass="java.util.Map" >
     SELECT count(1) as ID from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
   	   from C_T_CUSTOMER where 1=1
   	    and RECORD_STATE=1
		and  length(CUSTOMER_CODE) =  '$codeLength$'
		and CUSTOMER_CODE like '$superiorCode$%'
     ) where 1=1
  </select>
  
  <select id="selectUnitWithSubUnit" resultMap="CustomerResult_res" parameterClass="java.util.Map" >
    <!--
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
       查找用户单位的所有子单位以及子单位的下级单位
     * 历史信息查看中  客户列表用的
    -->
     SELECT * FROM ( SELECT ROWNUM AS NUMROW, c.* from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
	    from C_T_CUSTOMER where RECORD_STATE=1 
		<isNotEmpty prepend="AND" property="superiorCode">
		    CUSTOMER_CODE like '$superiorCode$%'
     	</isNotEmpty>
		<isNotEmpty prepend="AND" property="customerName">
     		CUSTOMER_NAME like '%$customerName$%'
     	</isNotEmpty>
     	<isNotEmpty property="customerLevel">
     		<isEqual compareValue="1" prepend="AND" property="customerLevel">
                CUSTOMER_LEVEL = '1'
            </isEqual>
     	</isNotEmpty>
     ) c) 
     <![CDATA[ WHERE NUMROW >= $ibegin$  AND NUMROW < $iend$  ]]>
  </select>
  <select id="selectUnitWithSubUnitCount" resultClass="java.lang.String" parameterClass="java.util.Map" >
     SELECT count(1) as ID from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
   	   from C_T_CUSTOMER where RECORD_STATE=1 
		<isNotEmpty prepend="AND" property="superiorCode">
		    CUSTOMER_CODE like '$superiorCode$%'
     	</isNotEmpty>
		<isNotEmpty prepend="AND" property="customerName">
     		CUSTOMER_NAME like '%$customerName$%'
     	</isNotEmpty>
     	<isNotEmpty property="customerLevel">
     		<isEqual compareValue="1" prepend="AND" property="customerLevel">
                CUSTOMER_LEVEL = '1'
            </isEqual>
     	</isNotEmpty>
     )
  </select>
  
     <select id="selectAllSubUnit" resultMap="CustomerResult_res" parameterClass="java.util.Map" >
    <!--
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
      客户管理员在创建下级单位管理员的时候查看还没有下级单位管理员的下级单位
    -->
     SELECT * FROM ( SELECT ROWNUM AS NUMROW, c.* from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
	    from C_T_CUSTOMER where 1=1 
	    and RECORD_STATE=1
		and  length(CUSTOMER_CODE) =  '$codeLength$'
		and CUSTOMER_CODE like '$superiorCode$%'
	    <isNotNull property="customerName">
				<isNotEmpty  property="customerName">
				 and  CUSTOMER_NAME like '%$customerName$%'
				</isNotEmpty>
	    </isNotNull>
		and customer_id not in(
           select seat.customer_id from c_t_seat seat
           where  seat.seat_is_admin=0
           and seat.seat_state=1
           and seat.seat_type=1
           and seat.customer_id is not null
           )
     ) c) 
     <![CDATA[ WHERE NUMROW >= $ibegin$  AND NUMROW < $iend$  ]]>
  </select>
   <select id="selectAllOfSubUnitCount" resultClass="java.lang.String" parameterClass="java.util.Map" >
     SELECT count(1) as ID from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
   	   from C_T_CUSTOMER where 1=1
   	    and RECORD_STATE=1
		and  length(CUSTOMER_CODE) =  '$codeLength$'
		and CUSTOMER_CODE like '$superiorCode$%'
		<isNotNull property="customerName">
				<isNotEmpty  property="customerName">
				 and  CUSTOMER_NAME like '%$customerName$%'
				</isNotEmpty>
	    </isNotNull>
		and customer_id not in(
           select seat.customer_id from c_t_seat seat
           where  seat.seat_is_admin=0
           and seat.seat_state=1
           and seat.seat_type=1
           and seat.customer_id is not null
     	   )
     ) where 1=1
  </select>
    <select id="selectAllCustomer" resultMap="CustomerResult_res" parameterClass="java.util.Map" >
    <!--
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
      新增加ws账号的时候，因为ws账号可以建立在任何单位，而且个数可以有多个，所以此时应该查询出所有的单位
    -->
     SELECT * FROM ( SELECT ROWNUM AS NUMROW, c.* from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
	    from C_T_CUSTOMER where 1=1 and RECORD_STATE=1
	    <isNotNull property="customerName">
				<isNotEmpty  property="customerName">
				 and  CUSTOMER_NAME like '%$customerName$%'
				</isNotEmpty>
	  </isNotNull>
     ) c) 
     <![CDATA[ WHERE NUMROW >= $ibegin$  AND NUMROW < $iend$  ]]>
  </select>
   <select id="selectWsAllOfCount" resultClass="java.lang.String" parameterClass="java.util.Map" >
    <!--
    新增ws账号时候需要显示全部单位的列表
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
    -->
     SELECT count(1) as ID from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE, RECORD_TYPE
    from C_T_CUSTOMER
     ) where 1=1
      and RECORD_STATE=1
      <isNotNull property="customerName">
				<isNotEmpty  property="customerName">
				 and  CUSTOMER_NAME like '%$customerName$%'
				</isNotEmpty>
	  </isNotNull>
  </select>
   <select id="selectAllNoPage" resultMap="CustomerResult" parameterClass="java.util.Map" >
    <!--
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
       查找所有数据，不进行分页
    -->
     SELECT * FROM ( SELECT ROWNUM AS NUMROW, c.* from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
    from C_T_CUSTOMER where 1=1 and RECORD_STATE=1
	and CUSTOMER_CODE like '$superiorCode$%'
	and  CUSTOMER_CODE !=  '$superiorCode$'
	 and  length(CUSTOMER_CODE) = '$codelength$'
     ) c) 
  </select>
  <delete id="deleteByPrimaryKey" parameterClass="cn.id5.idreal_hr.commons.bo.businesses.CustomerBO" >
    <!--
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
    -->
    update  C_T_CUSTOMER
    set RECORD_STATE=0
    where CUSTOMER_ID = #customerId#
  </delete>
  <insert id="insert" parameterClass="cn.id5.idreal_hr.commons.bo.businesses.CustomerBO" >
    <selectKey resultClass="java.lang.Long" keyProperty="customerId" >
      SELECT SEQ_DAILYOPERATION.NEXTVAL AS ID FROM DUAL
    </selectKey>
    insert into C_T_CUSTOMER (CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME,
      CUSTOMER_NAME, CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX,
      CUSTOMER_ZIP, CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY,
      BILLING_TYPE, APP_FIELD, WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP,
      OUTSTANDING, RECORD_STATE,RECORD_TYPE)
    values (#customerId#, #customerCode#, #customerLevel#, #customerShortName#, #customerName#,
      #customerContact#, #contactEmail#, #contactTel#, #contactMobile#, #contactFax#, #customerZip#,
      #customerAddress#, #customerSail#, #province#, #city#, #industryProperty#, #billingType#,
      #appField#, #webTestIp#, #webOfficialIp#, #wsTestIp#, #wsOfficialIp#, #outstanding#,
      1,0)
  </insert>
  <update id="updateByPrimaryKey" parameterClass="cn.id5.idreal_hr.commons.bo.businesses.CustomerBO" >
    <!--
      WARNING - This element is automatically generated by idreal_hr-Abator for SSI, do not modify.
      This element was generated on Fri Mar 19 13:25:03 CST 2010.
    -->
    update C_T_CUSTOMER
    set CUSTOMER_CODE = #customerCode#,
      CUSTOMER_LEVEL = #customerLevel#,
      CUSTOMER_SHORT_NAME = #customerShortName#,
      CUSTOMER_NAME = #customerName#,
      CUSTOMER_CONTACT = #customerContact#,
      CONTACT_EMAIL = #contactEmail#,
      CONTACT_TEL = #contactTel#,
      CONTACT_MOBILE = #contactMobile#,
      CONTACT_FAX = #contactFax#,
      CUSTOMER_ZIP = #customerZip#,
      CUSTOMER_ADDRESS = #customerAddress#,
      CUSTOMER_SAIL = #customerSail#,
      PROVINCE = #province#,
      CITY = #city#,
      INDUSTRY_PROPERTY = #industryProperty#,
      BILLING_TYPE = #billingType#,
      APP_FIELD = #appField#,
      WEB_TEST_IP = #webTestIp#,
      WEB_OFFICIAL_IP = #webOfficialIp#,
      WS_TEST_IP = #wsTestIp#,
      WS_OFFICIAL_IP = #wsOfficialIp#,
      OUTSTANDING = #outstanding#,
      RECORD_STATE = #recordState#,
      RECORD_TYPE=0
    where CUSTOMER_ID = #customerId#
  </update>
  
  <!-- 根据客户编号查找客户 -->
  <select id="selectByCustomerCode" resultMap="CustomerResult" parameterClass="String">
  	 select * from C_T_CUSTOMER where CUSTOMER_CODE = #value#
  </select>
  <!-- 设置客户账户余额提醒值 -->
  <update id="updateOts" parameterClass="cn.id5.idreal_hr.commons.bo.businesses.CustomerBO" >
    update C_T_CUSTOMER
    set OUTSTANDING = #outstanding# where CUSTOMER_ID = #customerId#
  </update>
  

 

<select id="selectUnitForStatistic" resultMap="CustomerResult" parameterClass="java.util.Map" >
    <!-- 业务统计量查询时用 -->
     SELECT * FROM ( SELECT ROWNUM AS NUMROW, c.* from ( 
     select m.CUSTOMER_ID, m.CUSTOMER_CODE, m.CUSTOMER_LEVEL, m.CUSTOMER_SHORT_NAME, m.CUSTOMER_NAME,
      m.CUSTOMER_CONTACT, m.CONTACT_EMAIL, m.CONTACT_TEL, m.CONTACT_MOBILE, m.CONTACT_FAX, m.CUSTOMER_ZIP,
      m.CUSTOMER_ADDRESS, m.CUSTOMER_SAIL, m.PROVINCE, y.CITY_NAME CITY, m.INDUSTRY_PROPERTY, m.BILLING_TYPE, m.APP_FIELD,
      m.WEB_TEST_IP, m.WEB_OFFICIAL_IP, m.WS_TEST_IP, m.WS_OFFICIAL_IP, m.OUTSTANDING, m.RECORD_STATE
     from C_T_CUSTOMER m,I_T_CITY y 
     where y.CITY_CODE=m.CITY
     and m.RECORD_STATE=1 
     <dynamic>
     	<isNotEmpty prepend="AND" property="customerName">
     		m.CUSTOMER_NAME like '%$customerName$%'
     	</isNotEmpty>
     	<isNotEmpty prepend="AND" property="customerId">
     		m.CUSTOMER_CODE like (select CUSTOMER_CODE from C_T_CUSTOMER where CUSTOMER_ID=$customerId$)||'%'
     	</isNotEmpty>
     	<isNotEmpty property="customerLevel">
     		<isEqual compareValue="1" prepend="AND" property="customerLevel">
                CUSTOMER_LEVEL = '1'
            </isEqual>
     	</isNotEmpty>
     </dynamic>
     ) c) 
     <![CDATA[ WHERE NUMROW >= $ibegin$  AND NUMROW < $iend$  ]]>
  </select>
  
  <select id="selectUnitForStatisticCount" resultClass="java.lang.String" parameterClass="java.util.Map" >
    <!-- 业务统计量查询时用 -->
     SELECT count(1) as ID FROM C_T_CUSTOMER m,I_T_CITY y where y.CITY_CODE=m.CITY and m.RECORD_STATE=1
     <dynamic>
     	<isNotEmpty prepend="AND" property="customerName">
     		m.CUSTOMER_NAME like '%$customerName$%'
     	</isNotEmpty>
     	<isNotEmpty prepend="AND" property="customerId">
     		m.CUSTOMER_CODE like (select CUSTOMER_CODE from C_T_CUSTOMER where CUSTOMER_ID=$customerId$)||'%'
     	</isNotEmpty>
     	<isNotEmpty property="customerLevel">
     		<isEqual compareValue="1" prepend="AND" property="customerLevel">
                CUSTOMER_LEVEL = '1'
            </isEqual>
     	</isNotEmpty>
     </dynamic>
  </select>
  
  <select id="selectSuperCustomer" resultMap="CustomerResult" parameterClass="cn.id5.idreal_hr.commons.bo.businesses.CustomerBO" >
    <!--
      根据客户（单位）id查找该客户的最顶级的单位
    -->
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE
    from C_T_CUSTOMER
    where CUSTOMER_CODE=(select substr(CUSTOMER_CODE,0,3) from C_T_CUSTOMER where CUSTOMER_ID=#customerId# and RECORD_STATE=1)
    and RECORD_STATE=1 
  </select>
  
  <select id="findEmployeeCustomers" resultMap="CustomerResult_res" parameterClass="java.util.Map" >
    <!--
      获取当前登录用户的所有客户
    -->
     SELECT * FROM ( SELECT ROWNUM AS NUMROW, c.* from ( 
        select c.CUSTOMER_ID, c.CUSTOMER_CODE, c.CUSTOMER_LEVEL, c.CUSTOMER_SHORT_NAME, c.CUSTOMER_NAME,
          c.CUSTOMER_CONTACT, c.CONTACT_EMAIL, c.CONTACT_TEL, c.CONTACT_MOBILE, c.CONTACT_FAX, c.CUSTOMER_ZIP,
          c.CUSTOMER_ADDRESS, c.CUSTOMER_SAIL, c.PROVINCE, c.CITY, c.INDUSTRY_PROPERTY, c.BILLING_TYPE, c.APP_FIELD,
          c.WEB_TEST_IP, c.WEB_OFFICIAL_IP, c.WS_TEST_IP, c.WS_OFFICIAL_IP, c.OUTSTANDING, c.RECORD_STATE
	    from C_T_CUSTOMER c, S_T_EMP_CUSTOMER ec 
	    where  ec.CUSTOMERID=c.CUSTOMER_ID 
	    and c.RECORD_STATE=1
	    <isNotEmpty prepend="AND" property="empId">
     		ec.EMPID='$empId$'
     	</isNotEmpty>
        <isNotEmpty prepend="AND" property="customerName">
     		c.CUSTOMER_NAME like '%$customerName$%'
     	</isNotEmpty>
     ) c) 
     <![CDATA[ WHERE NUMROW >= $ibegin$  AND NUMROW < $iend$]]>
  </select>
  
  <select id="findEmployeeCustomersCount" resultClass="java.lang.String" parameterClass="java.util.Map" >
     SELECT count(1) as ID from ( 
        select c.CUSTOMER_ID, c.CUSTOMER_CODE, c.CUSTOMER_LEVEL, c.CUSTOMER_SHORT_NAME, c.CUSTOMER_NAME,
          c.CUSTOMER_CONTACT, c.CONTACT_EMAIL, c.CONTACT_TEL, c.CONTACT_MOBILE, c.CONTACT_FAX, c.CUSTOMER_ZIP,
          c.CUSTOMER_ADDRESS, c.CUSTOMER_SAIL, c.PROVINCE, c.CITY, c.INDUSTRY_PROPERTY, c.BILLING_TYPE, c.APP_FIELD,
          c.WEB_TEST_IP, c.WEB_OFFICIAL_IP, c.WS_TEST_IP, c.WS_OFFICIAL_IP, c.OUTSTANDING, c.RECORD_STATE
	    from C_T_CUSTOMER c, S_T_EMP_CUSTOMER ec 
	    where  ec.CUSTOMERID=c.CUSTOMER_ID 
	    and c.RECORD_STATE=1
	    <isNotEmpty prepend="AND" property="empId">
     		ec.EMPID='$empId$'
     	</isNotEmpty>
        <isNotEmpty prepend="AND" property="customerName">
     		c.CUSTOMER_NAME like '%$customerName$%'
     	</isNotEmpty>
     )
  </select>
  
  <select id="selectCustomerIdByThrId" resultClass="java.lang.String" parameterClass="java.util.Map" >
    <!--
      根据交易历史表的thrId获取用户的customerId
    -->
    select c.CUSTOMER_ID 
    from M_T_TRANS_HIS_REC r,C_T_CUSTOMER c 
    where r.CUSTOMER_CODE=c.CUSTOMER_CODE and 
          c.RECORD_STATE=1 and rownum=1
          <isNotEmpty prepend="AND" property="thrId">
     	      r.THR_ID='$thrId$'
     	  </isNotEmpty>
  </select>
  
</sqlMap>