<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="DAILYOPERATION_C_T_CUSTOMER" >
  <resultMap id="CustomerResult" class="cn.id5.idreal_hr.commons.bo.dailyoperation.CustomerBO" >
    
    <result column="CUSTOMER_ID" property="customerId" jdbcType="DECIMAL" />
    <result column="CUSTOMER_CODE" property="customerCode" jdbcType="VARCHAR" />
    <result column="CUSTOMER_LEVEL" property="customerLevel" jdbcType="VARCHAR" />
    <result column="CUSTOMER_SHORT_NAME" property="customerShortName" jdbcType="VARCHAR" />
    <result column="CUSTOMER_NAME" property="customerName" jdbcType="VARCHAR" />
    <result column="CUSTOMER_CONTACT" property="customerContact" jdbcType="VARCHAR" />
    <result column="CONTACT_EMAIL" property="contactEmail" jdbcType="VARCHAR" />
    <result column="CONTACT_TEL" property="contactTel" jdbcType="VARCHAR" />
    <result column="CONTACT_MOBILE" property="contactMobile" jdbcType="VARCHAR" />
    <result column="CONTACT_FAX" property="contactFax" jdbcType="VARCHAR" />
    <result column="CUSTOMER_CONTACT2" property="customerContact2" jdbcType="VARCHAR" />
    <result column="CONTACT2_EMAIL" property="contact2Email" jdbcType="VARCHAR" />
    <result column="CONTACT2_TEL" property="contact2Tel" jdbcType="VARCHAR" />
    <result column="CONTACT2_MOBILE" property="contact2Mobile" jdbcType="VARCHAR" />
    <result column="CONTACT2_FAX" property="contact2Fax" jdbcType="VARCHAR" />
    <result column="CUSTOMER_ZIP" property="customerZip" jdbcType="VARCHAR" />
    <result column="CUSTOMER_ADDRESS" property="customerAddress" jdbcType="VARCHAR" />
    <result column="CUSTOMER_SAIL" property="customerSail" jdbcType="VARCHAR" />
    <result column="PROVINCE" property="province" jdbcType="VARCHAR" />
    <result column="CITY" property="city" jdbcType="VARCHAR" />
    <result column="INDUSTRY_PROPERTY" property="industryProperty" jdbcType="VARCHAR" />
    <result column="BILLING_TYPE" property="billingType" jdbcType="VARCHAR" />
    <result column="APP_FIELD" property="appField" jdbcType="VARCHAR" />
    <result column="WEB_TEST_IP" property="webTestIp" jdbcType="VARCHAR" />
    <result column="WEB_OFFICIAL_IP" property="webOfficialIp" jdbcType="VARCHAR" />
    <result column="WS_TEST_IP" property="wsTestIp" jdbcType="VARCHAR" />
    <result column="WS_OFFICIAL_IP" property="wsOfficialIp" jdbcType="VARCHAR" />
    <result column="OUTSTANDING" property="outstanding" jdbcType="DECIMAL" />
    <result column="RECORD_STATE" property="recordState" jdbcType="VARCHAR" />
    <result column="OUTSTANDING_TXZ" property="outstandingTxz" jdbcType="DECIMAL" />
    <result column="CUSTOMER_SOURCE" property="customerSource" jdbcType="VARCHAR" />
    <result column="RECORD_TYPE" property="recordType" jdbcType="VARCHAR" />
    <result column="ZS_CUSTOMER_ID" property="zsCustomerId" jdbcType="DECIMAL" />
    <result column="PAP_CODE" property="papCode" jdbcType="VARCHAR" />
    <result column="RECORD_TIME" property="recordTime" jdbcType="DATE" />
  </resultMap>
  
  
  <resultMap id="CustomerResult_res" class="cn.id5.idreal_hr.commons.bo.dailyoperation.CustomerBO" extends="CustomerResult">
  	<result property="customerTypeBO" column="BILLING_TYPE" select="GBOSS_S_T_CODE.getCodeBOByBillingType"/>
  	<result property="employeesBO" column="CUSTOMER_SAIL" select="GBOSS_S_T_EMPLOYEES.getUserByEmpCode"/>
  </resultMap>  
  
  
  <select id="selectByPrimaryKey" resultMap="CustomerResult_res" parameterClass="cn.id5.idreal_hr.commons.bo.dailyoperation.CustomerBO" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Tue Mar 30 15:18:33 CST 2010.
    -->
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_CONTACT2,
      CONTACT2_EMAIL, CONTACT2_TEL, CONTACT2_MOBILE, CONTACT2_FAX, CUSTOMER_ZIP, CUSTOMER_ADDRESS,
      CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD, WEB_TEST_IP,
      WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE, OUTSTANDING_TXZ,
      CUSTOMER_SOURCE, RECORD_TYPE, ZS_CUSTOMER_ID, PAP_CODE, RECORD_TIME
    from C_T_CUSTOMER
    where RECORD_STATE = 1
      and CUSTOMER_ID = #customerId#
  </select>
  
  
  <select id="listCode" resultMap="CustomerResult" >
    <!--
      查询现有客户编号列表
    -->
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_CONTACT2,
      CONTACT2_EMAIL, CONTACT2_TEL, CONTACT2_MOBILE, CONTACT2_FAX, CUSTOMER_ZIP, CUSTOMER_ADDRESS,
      CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD, WEB_TEST_IP,
      WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE, OUTSTANDING_TXZ,
      CUSTOMER_SOURCE, RECORD_TYPE, ZS_CUSTOMER_ID, PAP_CODE, RECORD_TIME
      from C_T_CUSTOMER
     where RECORD_STATE = 1	<!-- 非删除数据（显示数据） -->
       and CUSTOMER_LEVEL = 1
     order by CUSTOMER_CODE desc
  </select>
  
  <select id="getById" resultMap="CustomerResult" parameterClass="java.math.BigDecimal" >
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_CONTACT2,
      CONTACT2_EMAIL, CONTACT2_TEL, CONTACT2_MOBILE, CONTACT2_FAX, CUSTOMER_ZIP, CUSTOMER_ADDRESS,
      CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD, WEB_TEST_IP,
      WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE, OUTSTANDING_TXZ,
      CUSTOMER_SOURCE, RECORD_TYPE, ZS_CUSTOMER_ID, PAP_CODE, RECORD_TIME
     from C_T_CUSTOMER
    where CUSTOMER_ID = #value#
      and RECORD_STATE = 1
  </select>
  <select id="getByCode" resultMap="CustomerResult" parameterClass="java.lang.String" >
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_CONTACT2,
      CONTACT2_EMAIL, CONTACT2_TEL, CONTACT2_MOBILE, CONTACT2_FAX, CUSTOMER_ZIP, CUSTOMER_ADDRESS,
      CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD, WEB_TEST_IP,
      WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE, OUTSTANDING_TXZ,
      CUSTOMER_SOURCE, RECORD_TYPE, ZS_CUSTOMER_ID, PAP_CODE, RECORD_TIME
     from C_T_CUSTOMER
    where CUSTOMER_CODE = #value#
      and RECORD_STATE = 1
  </select>
  <select id="getByCodeForType" resultMap="CustomerResult" parameterClass="java.util.Map" >
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_CONTACT2,
      CONTACT2_EMAIL, CONTACT2_TEL, CONTACT2_MOBILE, CONTACT2_FAX, CUSTOMER_ZIP, CUSTOMER_ADDRESS,
      CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD, WEB_TEST_IP,
      WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE, OUTSTANDING_TXZ,
      CUSTOMER_SOURCE, RECORD_TYPE, ZS_CUSTOMER_ID, PAP_CODE, RECORD_TIME
     from C_T_CUSTOMER
    where CUSTOMER_CODE = #customerCode#
      and RECORD_STATE = 1
  </select>
  
  <select id="getCustomerCodeByType" resultMap="CustomerResult" parameterClass="java.util.Map" >
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_CONTACT2,
      CONTACT2_EMAIL, CONTACT2_TEL, CONTACT2_MOBILE, CONTACT2_FAX, CUSTOMER_ZIP, CUSTOMER_ADDRESS,
      CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD, WEB_TEST_IP,
      WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE, OUTSTANDING_TXZ,
      CUSTOMER_SOURCE, RECORD_TYPE, ZS_CUSTOMER_ID, PAP_CODE, RECORD_TIME
     from C_T_CUSTOMER
    where CUSTOMER_CODE = #customerCode#
      and RECORD_STATE = 1
  </select>
  <select id="subCustomerOfCount" resultClass="java.lang.Long" parameterClass="java.math.BigDecimal" >
    <!--
    	查询一级客户是否拥有对应二级客户
    -->
	select count(0)
	  from c_t_customer t
	 where substr(t.customer_code, 0, 3) = (
	        select t.customer_code
	          from c_t_customer t
	         where t.customer_id = #value#
	       )
	   and length(t.customer_code) > 3
	   and record_state = '1'
  </select>
  <select id="isDgFinish" resultClass="java.lang.Long" parameterClass="java.math.BigDecimal" >
    <!--
    	查询一级客户是成功订购，根据 customer_id 查询成功订购的正式数据行数是否在1行以上
    -->
	select count(0)
	  from C_T_CUSTOMER_PRODUCT t
	 where t.RECORD_STATE = 1
	   and t.CUSTOMER_ID = #value#
  </select>
  <!-- 检查客户正式名称是否存在重复值 checkCustomerNameDuplicate -->
  <select id="checkCustomerNameDuplicate" resultClass="java.lang.Long" parameterClass="java.lang.String" >
	select count(0)
	  from C_T_CUSTOMER
	 where RECORD_STATE = '1'
	 <!-- 
	   and RECORD_TYPE in (0,1)
	 -->
	  <dynamic>
		<isNotEmpty property="value">
	   and CUSTOMER_NAME = #value#
		</isNotEmpty>
		<isEmpty property="value">
	   and CUSTOMER_NAME is null
		</isEmpty>
	  </dynamic>
  </select>
  <select id="getStServiceTypeState" resultClass="java.lang.String" parameterClass="java.util.Map" >
	select ST_SERVICE_TYPE_STATE
	  from C_T_SERVICE_TYPE
	 where CP_ID in (  select CP_ID
	                     from C_T_CUSTOMER_PRODUCT
	                    where CUSTOMER_ID = #customerId#
	                      and PRODUCT_ID = #productId#
	                      and OPER_STATE=1
	                 )
	   and ST_SERVICE_TYPE = #stServiceType#
	   <!--  
	   <![CDATA[ 
	   and PI_START_DATE <= sysdate 
	   ]]>
	   -->
  </select>
  <select id="selectAll" resultMap="CustomerResult" parameterClass="java.util.Map" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Tue Mar 30 15:18:33 CST 2010.
    -->
     SELECT * FROM ( SELECT ROWNUM AS NUMROW, c.* from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_CONTACT2,
      CONTACT2_EMAIL, CONTACT2_TEL, CONTACT2_MOBILE, CONTACT2_FAX, CUSTOMER_ZIP, CUSTOMER_ADDRESS,
      CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD, WEB_TEST_IP,
      WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE, OUTSTANDING_TXZ,
      CUSTOMER_SOURCE, RECORD_TYPE, ZS_CUSTOMER_ID, PAP_CODE, RECORD_TIME
    from C_T_CUSTOMER
    where RECORD_STATE = 1 
      and CUSTOMER_LEVEL = 1
    <isNotNull property="customerCode"><isNotEmpty  property="customerCode">
      and CUSTOMER_CODE = #customerCode#
	</isNotEmpty></isNotNull>
    
	<!--  
    <isNull property="recordType">
      and (RECORD_TYPE = 0 or (RECORD_TYPE = 1 and ZS_CUSTOMER_ID is null))
	</isNull>
	-->
    <isNotNull property="customerName">
		<isNotEmpty  property="customerName">
      	and CUSTOMER_NAME like '%$customerName$%' 
		</isNotEmpty>
	</isNotNull>
    <isNotNull property="customerShortName">
		<isNotEmpty  property="customerShortName">
      	and CUSTOMER_SHORT_NAME like '%$customerShortName$%' 
		</isNotEmpty>
	</isNotNull>
    <isNotNull property="customerSail">
		<isNotEmpty  property="customerSail">
      	and CUSTOMER_SAIL in ('$customerSail$')
		</isNotEmpty>
		<isEmpty  property="customerSail">
      	and 1=2
		</isEmpty>
	</isNotNull>
    <isNull property="customerSail">
      	and 1=2
	</isNull>
	  order by CUSTOMER_ID desc
     ) c) 
     <![CDATA[ WHERE NUMROW >= $ibegin$  AND NUMROW < $iend$  ]]>
  </select>
  <select id="selectAllOfCount" resultClass="java.lang.String" parameterClass="java.util.Map" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Tue Mar 30 15:18:33 CST 2010.
    -->
     SELECT count(1) as ID from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_CONTACT2,
      CONTACT2_EMAIL, CONTACT2_TEL, CONTACT2_MOBILE, CONTACT2_FAX, CUSTOMER_ZIP, CUSTOMER_ADDRESS,
      CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD, WEB_TEST_IP,
      WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE, OUTSTANDING_TXZ,
      CUSTOMER_SOURCE, RECORD_TYPE, ZS_CUSTOMER_ID, PAP_CODE, RECORD_TIME
    from C_T_CUSTOMER
    where RECORD_STATE = 1 
      and CUSTOMER_LEVEL = 1
    <isNotNull property="customerCode"><isNotEmpty  property="customerCode">
      and CUSTOMER_CODE = #customerCode#
	</isNotEmpty></isNotNull>
    
    <isNotNull property="customerName">
		<isNotEmpty  property="customerName">
      	and CUSTOMER_NAME like '%$customerName$%' 
		</isNotEmpty>
	</isNotNull>
    <isNotNull property="customerShortName">
		<isNotEmpty  property="customerShortName">
      	and CUSTOMER_SHORT_NAME like '%$customerShortName$%' 
		</isNotEmpty>
	</isNotNull>
    <isNotNull property="customerSail">
		<isNotEmpty property="customerSail">
      	and CUSTOMER_SAIL in ('$customerSail$') 
		</isNotEmpty>
		<isEmpty property="customerSail">
      	and 1=2
		</isEmpty>
	</isNotNull>
    <isNull property="customerSail">
      	and 1=2
	</isNull>
     ) 
  </select>
  
  
  <delete id="deleteByPrimaryKey" parameterClass="cn.id5.idreal_hr.commons.bo.dailyoperation.CustomerBO" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Tue Mar 30 15:18:33 CST 2010.
    -->
    delete from C_T_CUSTOMER
    where CUSTOMER_ID = #customerId#
  </delete>
  <insert id="insert" parameterClass="cn.id5.idreal_hr.commons.bo.dailyoperation.CustomerBO" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Tue Mar 30 15:18:33 CST 2010.
    -->
    <selectKey resultClass="java.math.BigDecimal" keyProperty="customerId" >
      SELECT SEQ_DAILYOPERATION.NEXTVAL AS ID FROM DUAL
    </selectKey>
    insert into C_T_CUSTOMER (CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME,
      CUSTOMER_NAME, CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX,
      CUSTOMER_CONTACT2, CONTACT2_EMAIL, CONTACT2_TEL, CONTACT2_MOBILE, CONTACT2_FAX, CUSTOMER_ZIP,
      CUSTOMER_ADDRESS, CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD,
      WEB_TEST_IP, WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE, OUTSTANDING_TXZ,
      CUSTOMER_SOURCE, RECORD_TYPE, ZS_CUSTOMER_ID, PAP_CODE, RECORD_TIME)
    values (#customerId#, #customerCode#, 1, #customerShortName#, #customerName#,
      #customerContact#, #contactEmail#, #contactTel#, #contactMobile#, #contactFax#,
      #customerContact2#, #contact2Email#, #contact2Tel#, #contact2Mobile#, #contact2Fax#,
      #customerZip#, #customerAddress#, #customerSail#, #province#, #city#, #industryProperty#,
      #billingType#, #appField#, #webTestIp#, #webOfficialIp#, #wsTestIp#, #wsOfficialIp#,
      0, 1, #outstandingTxz#, #customerSource#, 0, #zsCustomerId#, 
      #papCode#, #recordTime#)
  </insert>
  <update id="updateByPrimaryKey" parameterClass="cn.id5.idreal_hr.commons.bo.dailyoperation.CustomerBO" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Tue Mar 30 15:18:33 CST 2010.
      , PAP_CODE = #papCode#
    -->
    update C_T_CUSTOMER
    set 
     <dynamic>
     	<isNotEmpty property="customerCode">
      	CUSTOMER_CODE = #customerCode#,
		</isNotEmpty>
		<isNotEmpty  property="customerLevel">
      	CUSTOMER_LEVEL = #customerLevel#,
		</isNotEmpty>
		<isNotEmpty  property="customerName">
      	CUSTOMER_NAME = #customerName#,
		</isNotEmpty>
		<isNotEmpty  property="billingType">
      	BILLING_TYPE = #billingType#,
		</isNotEmpty>
		<isNotEmpty  property="customerSail">
      	CUSTOMER_SAIL = #customerSail#,
		</isNotEmpty>
      CUSTOMER_SHORT_NAME = #customerShortName#,
      CUSTOMER_CONTACT = #customerContact#,
      CONTACT_EMAIL = #contactEmail#,
      CONTACT_TEL = #contactTel#,
      CONTACT_MOBILE = #contactMobile#,
      CONTACT_FAX = #contactFax#,
      CUSTOMER_CONTACT2 = #customerContact2#,
      CONTACT2_EMAIL = #contact2Email#,
      CONTACT2_TEL = #contact2Tel#,
      CONTACT2_MOBILE = #contact2Mobile#,
      CONTACT2_FAX = #contact2Fax#,
      CUSTOMER_ZIP = #customerZip#,
      CUSTOMER_ADDRESS = #customerAddress#,
      PROVINCE = #province#,
      CITY = #city#,
      INDUSTRY_PROPERTY = #industryProperty#,
      APP_FIELD = #appField#,
	  WEB_OFFICIAL_IP = #webOfficialIp#,
	  WS_OFFICIAL_IP = #wsOfficialIp#,
      WEB_TEST_IP = #webTestIp#,
      WS_TEST_IP = #wsTestIp#,
      OUTSTANDING_TXZ = #outstandingTxz#,
      CUSTOMER_SOURCE = #customerSource#
		<isNotEmpty property="zsCustomerId">
      	,ZS_CUSTOMER_ID = #zsCustomerId#
		</isNotEmpty>
		
		<isNotEmpty  property="outstanding">
      	,OUTSTANDING = #outstanding#
		</isNotEmpty>
		<isNotEmpty  property="recordState">
		,RECORD_STATE = #recordState#
		</isNotEmpty>
		<isNotEmpty  property="recordTime">
		,RECORD_TIME = #recordTime#
		</isNotEmpty>
     </dynamic>
    where CUSTOMER_ID = #customerId#
  </update>
  
  
  <!-- === 自加 ========================================================================== -->
  <select id="selectMaxCustomerCode" resultClass="java.lang.String" >
    <!--
      取出目前一级客户编号最大值 + 1
     select max(customer_code)+1 from c_t_customer where customer_level = 1
     nvl(to_char(max(customer_code)+1,'009'),'001')
    -->
     select nvl(to_char(max(customer_code)+1,'009'),'001') from c_t_customer where customer_level = 1 and length(customer_code)=3
  </select>
  <update id="updateRecordStateById" parameterClass="cn.id5.idreal_hr.commons.bo.dailyoperation.CustomerBO" >
    <!--
      用于做删除标记，根据id使RECORD_STATE字段值为0
    -->
    update C_T_CUSTOMER
       set RECORD_STATE = 0
     where CUSTOMER_ID = #customerId#
  </update>
  <select id="wholeData" resultMap="CustomerResult" parameterClass="java.lang.String" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Tue Mar 30 15:18:33 CST 2010.
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_NAME
    -->
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_CONTACT2,
      CONTACT2_EMAIL, CONTACT2_TEL, CONTACT2_MOBILE, CONTACT2_FAX, CUSTOMER_ZIP, CUSTOMER_ADDRESS,
      CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD, WEB_TEST_IP,
      WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE, OUTSTANDING_TXZ,
      CUSTOMER_SOURCE, RECORD_TYPE, ZS_CUSTOMER_ID, PAP_CODE, RECORD_TIME
      from C_T_CUSTOMER
     where RECORD_STATE = 1 
       and CUSTOMER_LEVEL = 1
	 
  </select>
  
  
  
  <select id="selectByCustomerName" resultMap="CustomerResult" parameterClass="cn.id5.idreal_hr.commons.bo.dailyoperation.CustomerBO" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Thu Apr 22 10:34:21 CST 2010.
    -->
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_CONTACT2,
      CONTACT2_EMAIL, CONTACT2_TEL, CONTACT2_MOBILE, CONTACT2_FAX, CUSTOMER_ZIP, CUSTOMER_ADDRESS,
      CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD, WEB_TEST_IP,
      WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE, OUTSTANDING_TXZ,
      CUSTOMER_SOURCE, RECORD_TYPE, ZS_CUSTOMER_ID, PAP_CODE, RECORD_TIME
    from C_T_CUSTOMER
    where CUSTOMER_NAME = #customerName#
  </select>
  
  
  <select id="selectByCId" resultMap="CustomerResult" parameterClass="java.math.BigDecimal" >
    select *
    from C_T_CUSTOMER
    where CUSTOMER_ID = #value#
  </select>
  
  <!-- 查询级别为1所有客户 -->
  <select id="selectAllCustomer" resultMap="CustomerResult_res" parameterClass="java.util.Map" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Tue Mar 30 15:18:33 CST 2010.
    -->
     SELECT * FROM ( SELECT ROWNUM AS NUMROW, c.* from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_CONTACT2,
      CONTACT2_EMAIL, CONTACT2_TEL, CONTACT2_MOBILE, CONTACT2_FAX, CUSTOMER_ZIP, CUSTOMER_ADDRESS,
      CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD, WEB_TEST_IP,
      WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE, OUTSTANDING_TXZ,
      CUSTOMER_SOURCE, RECORD_TYPE, ZS_CUSTOMER_ID, PAP_CODE, RECORD_TIME
    from C_T_CUSTOMER where RECORD_STATE = 1 and CUSTOMER_LEVEL = 1 
	 <dynamic>
	 	<isNotEmpty prepend="and" property="customerName">
	 		CUSTOMER_NAME like '%$customerName$%'
	 	</isNotEmpty>
	 	<isNotEmpty prepend="and" property="customerCode">
	 		CUSTOMER_CODE = #customerCode#
	 	</isNotEmpty>
	 	<isNotEmpty property="billingType">
	 		<isNotEqual property="billingType" compareValue="0">
	 			and BILLING_TYPE = #billingType#
	 		</isNotEqual>
	 	</isNotEmpty>
	 </dynamic>
	 ORDER BY CUSTOMER_ID DESC
     ) c) 
      <![CDATA[ WHERE NUMROW >= $ibegin$  AND NUMROW < $iend$  ]]>
  </select>
  
  <!-- 查询级别为1所有客户记录数 -->
  <select id="selectAllCustomerOfCount" resultClass="java.lang.String" parameterClass="java.util.Map" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Tue Mar 30 15:18:33 CST 2010.
    -->
     SELECT count(1) as ID FROM ( SELECT ROWNUM AS NUMROW, c.* from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_CONTACT2,
      CONTACT2_EMAIL, CONTACT2_TEL, CONTACT2_MOBILE, CONTACT2_FAX, CUSTOMER_ZIP, CUSTOMER_ADDRESS,
      CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD, WEB_TEST_IP,
      WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE, OUTSTANDING_TXZ,
      CUSTOMER_SOURCE, RECORD_TYPE, ZS_CUSTOMER_ID, PAP_CODE, RECORD_TIME
    from C_T_CUSTOMER where RECORD_STATE = 1 and CUSTOMER_LEVEL = 1 
    <dynamic>
	 	<isNotEmpty prepend="and" property="customerName">
	 		CUSTOMER_NAME like '%$customerName$%'
	 	</isNotEmpty>
	 	<isNotEmpty prepend="and" property="customerCode">
	 		CUSTOMER_CODE = #customerCode#
	 	</isNotEmpty>
	 	<isNotEmpty property="billingType">
	 		<isNotEqual property="billingType" compareValue="0">
	 			and BILLING_TYPE = #billingType#
	 		</isNotEqual>
	 	</isNotEmpty>
	 </dynamic>
	 ORDER BY CUSTOMER_ID DESC
     ) c) 
  </select>
  
  <!-- 根据客户编号查询客户信息 gaobo -->
  <select id="selectByCustomerCode" resultMap="CustomerResult_res" parameterClass="java.lang.String" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Tue Mar 30 15:18:33 CST 2010.
    -->
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_CONTACT2,
      CONTACT2_EMAIL, CONTACT2_TEL, CONTACT2_MOBILE, CONTACT2_FAX, CUSTOMER_ZIP, CUSTOMER_ADDRESS,
      CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD, WEB_TEST_IP,
      WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE, OUTSTANDING_TXZ,
      CUSTOMER_SOURCE, RECORD_TYPE, ZS_CUSTOMER_ID, PAP_CODE, RECORD_TIME
    from C_T_CUSTOMER
    where CUSTOMER_CODE = #customerCode# and RECORD_STATE='1'
  </select>
  

  
   <!-- 查询销售人员及其代表下级别为1所有客户 gaobo-->
  <select id="selectAllCustomerBySail" resultMap="CustomerResult_res" parameterClass="java.util.Map" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Tue Mar 30 15:18:33 CST 2010.
    -->
     SELECT * FROM ( SELECT ROWNUM AS NUMROW, c.* from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_CONTACT2,
      CONTACT2_EMAIL, CONTACT2_TEL, CONTACT2_MOBILE, CONTACT2_FAX, CUSTOMER_ZIP, CUSTOMER_ADDRESS,
      CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD, WEB_TEST_IP,
      WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE, OUTSTANDING_TXZ,
      CUSTOMER_SOURCE, RECORD_TYPE, ZS_CUSTOMER_ID, PAP_CODE, RECORD_TIME
    from C_T_CUSTOMER where RECORD_STATE = 1 and CUSTOMER_LEVEL = 1 
             and CUSTOMER_SAIL in 
             (select s.UU_NAME from S_T_USER_US s, S_T_USER u 
               where s.user_id=u.user_id and s.UU_TYPE = 1 and u.user_type=1 
               and u.user_name=#sail#
              )  
	 <dynamic>
	 	<isNotEmpty prepend="and" property="customerCode">
	 		CUSTOMER_CODE = #customerCode#
	 	</isNotEmpty>
	 	<isNotEmpty prepend="and" property="customerName">
	 		CUSTOMER_NAME like '%$customerName$%'
	 	</isNotEmpty>
	 	<isNotEmpty property="billingType">
	 		<isNotEqual property="billingType" compareValue="0">
	 			and BILLING_TYPE = #billingType#
	 		</isNotEqual>
	 	</isNotEmpty>
	 </dynamic>
	 ORDER BY CUSTOMER_ID DESC
     ) c) 
      <![CDATA[ WHERE NUMROW >= $ibegin$  AND NUMROW < $iend$  ]]>
  </select>
  
  <!-- 查询销售人员及其代表下级别为1所有客户的记录数 gaobo-->
  <select id="selectAllCustomerBySailOfCount" resultClass="java.lang.String" parameterClass="java.util.Map" >
    <!--
      WARNING - This element is automatically generated by GBOSS-Abator for SSI, do not modify.
      This element was generated on Tue Mar 30 15:18:33 CST 2010.
    -->
     SELECT count(1) as ID FROM ( SELECT ROWNUM AS NUMROW, c.* from ( 
    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_CONTACT2,
      CONTACT2_EMAIL, CONTACT2_TEL, CONTACT2_MOBILE, CONTACT2_FAX, CUSTOMER_ZIP, CUSTOMER_ADDRESS,
      CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD, WEB_TEST_IP,
      WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE, OUTSTANDING_TXZ,
      CUSTOMER_SOURCE, RECORD_TYPE, ZS_CUSTOMER_ID, PAP_CODE, RECORD_TIME
    from C_T_CUSTOMER where RECORD_STATE = 1 and CUSTOMER_LEVEL = 1 
         and CUSTOMER_SAIL in 
             (select s.UU_NAME from S_T_USER_US s, S_T_USER u 
               where s.user_id=u.user_id and s.UU_TYPE = 1 and u.user_type=1 
               and u.user_name=#sail#
              )  
    <dynamic>
	 	<isNotEmpty prepend="and" property="customerCode">
	 		CUSTOMER_CODE = #customerCode#
	 	</isNotEmpty>
	 	<isNotEmpty prepend="and" property="customerName">
	 		CUSTOMER_NAME like '%$customerName$%'
	 	</isNotEmpty>
	 	<isNotEmpty property="billingType">
	 		<isNotEqual property="billingType" compareValue="0">
	 			and BILLING_TYPE = #billingType#
	 		</isNotEqual>
	 	</isNotEmpty>
	 </dynamic>
	 ORDER BY CUSTOMER_ID DESC
     ) c) 
  </select>
  
  
  <!-- 根据客户编号得到客户的历史记录数据量 (RECORD_TYPE = 2)  kong-->
  <select id="getHistoryListOfCountByCustomerCode" resultClass="java.lang.String" parameterClass="java.util.Map" >
     SELECT count(1) as ID FROM ( SELECT ROWNUM AS NUMROW, c.* from ( 
	    select CUSTOMER_ID, CUSTOMER_CODE, CUSTOMER_LEVEL, CUSTOMER_SHORT_NAME, CUSTOMER_NAME,
	      CUSTOMER_CONTACT, CONTACT_EMAIL, CONTACT_TEL, CONTACT_MOBILE, CONTACT_FAX, CUSTOMER_CONTACT2,
	      CONTACT2_EMAIL, CONTACT2_TEL, CONTACT2_MOBILE, CONTACT2_FAX, CUSTOMER_ZIP, CUSTOMER_ADDRESS,
	      CUSTOMER_SAIL, PROVINCE, CITY, INDUSTRY_PROPERTY, BILLING_TYPE, APP_FIELD, WEB_TEST_IP,
	      WEB_OFFICIAL_IP, WS_TEST_IP, WS_OFFICIAL_IP, OUTSTANDING, RECORD_STATE, OUTSTANDING_TXZ,
	      CUSTOMER_SOURCE, RECORD_TYPE, ZS_CUSTOMER_ID, PAP_CODE,RECORD_TIME
	     from C_T_CUSTOMER
	    where CUSTOMER_CODE = #customerCode#
	      and RECORD_STATE = 1
	      order by PAP_CODE desc
     ) c) 
  </select>
</sqlMap>